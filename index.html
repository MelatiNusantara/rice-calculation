<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Kalkulator Kelayakan Usaha Tani Padi</title>
  <style>
    :root {
      --pacific-blue: #1B365D;
      --sustainable-teal: #2D7D7D;
      --coral-innovation: #FF6B47;
      --pearl-white: #F8F9FA;
      --pearl-light: #FFFFFF;
      --text-secondary: #666;
      --border-light: #E8F4F8;
    }

    body {
      font-family: 'Segoe UI', Tahoma, sans-serif;
      background-color: var(--pearl-white);
      margin: 0;
      padding: 20px;
      color: var(--pacific-blue);
    }

    .container {
      max-width: 900px;
      margin: auto;
      background: var(--pearl-light);
      padding: 40px;
      border-radius: 14px;
      box-shadow: 0 8px 25px rgba(0,0,0,0.08);
    }

    h1 {
      text-align: center;
      color: var(--pacific-blue);
      font-size: 28px;
      margin-bottom: 25px;
    }

    h2 {
      color: var(--sustainable-teal);
      border-left: 6px solid var(--coral-innovation);
      padding-left: 12px;
      margin-top: 35px;
      margin-bottom: 20px;
      font-size: 20px;
    }

    .input-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 25px;
      margin-bottom: 20px;
    }

    .input-group {
      display: flex;
      flex-direction: column;
    }

    label {
      margin-bottom: 6px;
      font-weight: 600;
      font-size: 14px;
      color: var(--pacific-blue);
    }

    input {
      padding: 12px;
      border: 1px solid var(--border-light);
      border-radius: 8px;
      font-size: 15px;
      transition: border-color 0.3s;
    }
    input:focus {
      border-color: var(--sustainable-teal);
      outline: none;
    }

    button {
      display: block;
      width: 100%;
      padding: 15px;
      background: var(--coral-innovation);
      color: #fff;
      border: none;
      border-radius: 8px;
      font-size: 18px;
      font-weight: bold;
      cursor: pointer;
      margin-top: 20px;
      transition: background-color 0.3s;
    }
    button:hover {
      background: #e25838;
    }

    .output-section {
      margin-top: 30px;
      padding: 25px;
      border-radius: 12px;
      background-color: var(--pearl-white);
      border: 1px solid var(--border-light);
      display: none;
    }

    .output-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 25px;
      margin-top: 20px;
    }

    .result-card {
      background-color: var(--pearl-light);
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.05);
      border-top: 4px solid var(--sustainable-teal);
    }
    .result-card h3 {
      margin: 0 0 12px;
      font-size: 16px;
      color: var(--pacific-blue);
    }
    .result-card p {
      margin: 6px 0;
      font-size: 16px;
      font-weight: bold;
      color: #333;
    }
    .result-card .label {
      display: block;
      font-size: 12px;
      font-weight: normal;
      color: var(--text-secondary);
    }

    .good { color: #27ae60; }
    .bad { color: #e74c3c; }

    .packaging-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
      gap: 15px;
      margin-top: 10px;
    }
    .packaging-grid label { font-size: 13px; margin-bottom: 4px; }
    .packaging-grid input { padding: 10px; }
  </style>
</head>
<body>
  <div class="container">
    <h1>üåæ Kalkulator Kelayakan Usaha Tani Padi</h1>

    <!-- Form On-Farm -->
    <form id="farmCalculator">
      <h2>üå± Parameter Lahan & Produksi</h2>
      <div class="input-grid">
        <div class="input-group">
          <label for="luasLahan">Luas Cluster (ha)</label>
          <input type="number" id="luasLahan" value="870.5" step="0.1" required>
        </div>
        <div class="input-group">
          <label for="produktivitasGKP">Produktivitas GKP (ton/ha)</label>
          <input type="number" id="produktivitasGKP" value="5" step="0.1" required>
        </div>
        <div class="input-group">
          <label for="indexTanam">Index Tanam (kali/tahun)</label>
          <input type="number" id="indexTanam" value="2" step="1" required>
        </div>
      </div>

      <h2>üí∞ Parameter Biaya & Harga</h2>
      <div class="input-grid">
        <div class="input-group">
          <label for="biayaTenagaKerja">Biaya Tenaga Kerja (Rp)</label>
          <input type="number" id="biayaTenagaKerja" value="5200000" required>
        </div>
        <div class="input-group">
          <label for="biayaLogistik">Biaya Logistik (Rp)</label>
          <input type="number" id="biayaLogistik" value="3054000" required>
        </div>
        <div class="input-group">
          <label for="biayaSewa">Biaya Sewa/Borongan (Rp)</label>
          <input type="number" id="biayaSewa" value="5000000" required>
        </div>
        <div class="input-group">
          <label for="biayaAdmin">Biaya Administrasi (Rp)</label>
          <input type="number" id="biayaAdmin" value="371112" required>
        </div>
        <div class="input-group">
          <label for="hargaGKP">Harga Jual GKP (Rp/kg)</label>
          <input type="number" id="hargaGKP" value="4500" required>
        </div>
      </div>
      <button type="button" onclick="calculate()">Hitung Kelayakan Awal</button>
    </form>

    <!-- Output On-Farm -->
    <div id="outputSection" class="output-section">
      <h2>üìä Hasil Analisis On-Farm</h2>
      <div class="output-grid">
        <div class="result-card" id="outputPerHektar"></div>
        <div class="result-card" id="outputTotalCluster"></div>
      </div>
    </div>

    <!-- Form Penggilingan -->
    <div id="millingSection" class="output-section">
      <h2>üè≠ Parameter Penggilingan & Pengemasan</h2>
      <div class="input-grid">
        <div class="input-group">
          <label for="rendemenGKG">Rendemen GKP ‚ûú GKG (%)</label>
          <input type="number" id="rendemenGKG" value="86" step="0.1" required>
        </div>
        <div class="input-group">
          <label for="rendemenBeras">Rendemen GKG ‚ûú Beras (%)</label>
          <input type="number" id="rendemenBeras" value="62.74" step="0.01" required>
        </div>
        <div class="input-group">
          <label for="proporsiMedium">Proporsi Beras Medium (%)</label>
          <input type="number" id="proporsiMedium" value="75" step="1" required>
        </div>
        <div class="input-group">
          <label for="proporsiPremium">Proporsi Beras Premium (%)</label>
          <input type="number" id="proporsiPremium" value="25" step="1" required>
        </div>
      </div>

      <h3>üì¶ Strategi Pengemasan Medium (%)</h3>
      <div class="packaging-grid">
        <div class="input-group"><label for="packMedium5">5 kg</label><input type="number" id="packMedium5" value="25" required></div>
        <div class="input-group"><label for="packMedium10">10 kg</label><input type="number" id="packMedium10" value="25" required></div>
        <div class="input-group"><label for="packMedium25">25 kg</label><input type="number" id="packMedium25" value="50" required></div>
      </div>

      <h3>üì¶ Strategi Pengemasan Premium (%)</h3>
      <div class="packaging-grid">
        <div class="input-group"><label for="packPremium5">5 kg</label><input type="number" id="packPremium5" value="50" required></div>
        <div class="input-group"><label for="packPremium10">10 kg</label><input type="number" id="packPremium10" value="25" required></div>
        <div class="input-group"><label for="packPremium25">25 kg</label><input type="number" id="packPremium25" value="25" required></div>
      </div>
      <button type="button" onclick="calculateMilling()">Hitung Hasil Penggilingan</button>

      <!-- Output Milling -->
      <div id="millingOutputContainer" style="display:none; margin-top:30px;">
        <h2>üìà Hasil Akhir Proses Penggilingan</h2>
        <div class="output-grid">
          <div class="result-card" id="outputMillingResult"></div>
          <div class="result-card" id="outputPackaging"></div>
        </div>
      </div>
    </div>
  </div>

<script>
// Variabel global untuk menyimpan hasil
let totalProduksiGKP_tahunan = 0;
let totalBeras_ton = 0;

function formatAngka(angka) {
    return new Intl.NumberFormat('id-ID').format(angka);
}

function formatRupiah(angka) {
    return new Intl.NumberFormat('id-ID', { style: 'currency', currency: 'IDR', minimumFractionDigits: 0 }).format(angka);
}

function calculate() {
    const luasLahan = parseFloat(document.getElementById('luasLahan').value);
    const produktivitasGKP = parseFloat(document.getElementById('produktivitasGKP').value);
    const indexTanam = parseFloat(document.getElementById('indexTanam').value);
    const biayaTenagaKerja = parseFloat(document.getElementById('biayaTenagaKerja').value);
    const biayaLogistik = parseFloat(document.getElementById('biayaLogistik').value);
    const biayaSewa = parseFloat(document.getElementById('biayaSewa').value);
    const biayaAdmin = parseFloat(document.getElementById('biayaAdmin').value);
    const hargaGKP = parseFloat(document.getElementById('hargaGKP').value);

    const totalBiaya_perHa = biayaTenagaKerja + biayaLogistik + biayaSewa + biayaAdmin;
    const produksiGKP_kg_perHa = produktivitasGKP * 1000;
    const penerimaan_perHa = produksiGKP_kg_perHa * hargaGKP;
    const keuntungan_perHa = penerimaan_perHa - totalBiaya_perHa;
    const hppGKP_perKg = totalBiaya_perHa / produksiGKP_kg_perHa;
    const rcRatio = penerimaan_perHa / totalBiaya_perHa;

    totalProduksiGKP_tahunan = luasLahan * produktivitasGKP * indexTanam;
    
    const totalPendapatan_tahunan = luasLahan * penerimaan_perHa * indexTanam;
    const totalBiaya_tahunan = luasLahan * totalBiaya_perHa * indexTanam;
    const totalKeuntungan_tahunan = luasLahan * keuntungan_perHa * indexTanam;

    document.getElementById('outputSection').style.display = 'block';
    document.getElementById('millingSection').style.display = 'block';

    document.getElementById('outputPerHektar').innerHTML = `
        <h3>Analisis per Hektar (per Siklus)</h3>
        <p>${formatRupiah(penerimaan_perHa)}<span class="label">Penerimaan dari GKP</span></p>
        <p>${formatRupiah(totalBiaya_perHa)}<span class="label">Total Biaya Budidaya</span></p>
        <p class="good">${formatRupiah(keuntungan_perHa)}<span class="label">Keuntungan Kotor (jika GKP dijual)</span></p>
        <hr>
        <p>${formatRupiah(hppGKP_perKg)} / kg<span class="label">Harga Pokok Produksi (HPP) GKP</span></p>
        <p class="${rcRatio >= 1 ? 'good' : 'bad'}">${rcRatio.toFixed(2)}<span class="label">R/C Ratio On-Farm</span></p>
    `;

    document.getElementById('outputTotalCluster').innerHTML = `
        <h3>Proyeksi Total Cluster (per Tahun)</h3>
        <p>${totalProduksiGKP_tahunan.toFixed(2)} ton<span class="label">Target Produksi GKP Tahunan</span></p>
        <p>${formatRupiah(totalPendapatan_tahunan)}<span class="label">Total Pendapatan (jika GKP dijual)</span></p>
        <p>${formatRupiah(totalBiaya_tahunan)}<span class="label">Total Biaya Budidaya</span></p>
        <p class="good">${formatRupiah(totalKeuntungan_tahunan)}<span class="label">Total Keuntungan (jika GKP dijual)</span></p>
    `;

    document.getElementById('outputSection').scrollIntoView({ behavior: 'smooth' });
}

function calculateMilling(){
    // Ambil total GKP dari variabel global
    const totalGKP = totalProduksiGKP_tahunan; 
    
    // Ambil input parameter penggilingan
    const rendemenGKG = parseFloat(document.getElementById('rendemenGKG').value) / 100;
    const rendemenBeras = parseFloat(document.getElementById('rendemenBeras').value) / 100;

    // Ambil input proporsi kualitas
    const proporsiMedium = parseFloat(document.getElementById('proporsiMedium').value) / 100;
    const proporsiPremium = parseFloat(document.getElementById('proporsiPremium').value) / 100;
    
    // Ambil input proporsi kemasan
    const packMedium5 = parseFloat(document.getElementById('packMedium5').value) / 100;
    const packMedium10 = parseFloat(document.getElementById('packMedium10').value) / 100;
    const packMedium25 = parseFloat(document.getElementById('packMedium25').value) / 100;
    const packPremium5 = parseFloat(document.getElementById('packPremium5').value) / 100;
    const packPremium10 = parseFloat(document.getElementById('packPremium10').value) / 100;
    const packPremium25 = parseFloat(document.getElementById('packPremium25').value) / 100;
    
    // --- LAKUKAN PERHITUNGAN PENGGILINGAN ---
    const totalGKG = totalGKP * rendemenGKG;
    totalBeras_ton = totalGKG * rendemenBeras;
    const totalBeras_kg = totalBeras_ton * 1000;
    
    // --- PERHITUNGAN BERAS PER KUALITAS ---
    const totalBerasMedium_kg = totalBeras_kg * proporsiMedium;
    const totalBerasPremium_kg = totalBeras_kg * proporsiPremium;

    // --- PERHITUNGAN JUMLAH KARUNG ---
    const karungMedium5 = (totalBerasMedium_kg * packMedium5) / 5;
    const karungMedium10 = (totalBerasMedium_kg * packMedium10) / 10;
    const karungMedium25 = (totalBerasMedium_kg * packMedium25) / 25;
    
    const karungPremium5 = (totalBerasPremium_kg * packPremium5) / 5;
    const karungPremium10 = (totalBerasPremium_kg * packPremium10) / 10;
    const karungPremium25 = (totalBerasPremium_kg * packPremium25) / 25;


    // --- TAMPILKAN HASIL ---
    document.getElementById("millingOutputContainer").style.display = "block";
    
    document.getElementById("outputMillingResult").innerHTML = `
        <h3>üì¶ Hasil Produksi Beras (per Tahun)</h3>
        <p>${totalGKG.toFixed(2)} ton<span class="label">Total GKG Dihasilkan</span></p>
        <p>${totalBeras_ton.toFixed(2)} ton<span class="label">Total Beras Dihasilkan</span></p>
        <hr>
        <p>${totalBerasMedium_kg.toLocaleString('id-ID')} kg<span class="label">Beras Kualitas Medium</span></p>
        <p>${totalBerasPremium_kg.toLocaleString('id-ID')} kg<span class="label">Beras Kualitas Premium</span></p>
    `;

    document.getElementById("outputPackaging").innerHTML = `
        <h3>üõçÔ∏è Rencana Pengemasan (Karung/Sak)</h3>
        <b>Kualitas Medium:</b>
        <p>${formatAngka(karungMedium5.toFixed(0))}<span class="label">Karung 5 kg</span></p>
        <p>${formatAngka(karungMedium10.toFixed(0))}<span class="label">Karung 10 kg</span></p>
        <p>${formatAngka(karungMedium25.toFixed(0))}<span class="label">Karung 25 kg</span></p>
        <b>Kualitas Premium:</b>
        <p>${formatAngka(karungPremium5.toFixed(0))}<span class="label">Karung 5 kg</span></p>
        <p>${formatAngka(karungPremium10.toFixed(0))}<span class="label">Karung 10 kg</span></p>
        <p>${formatAngka(karungPremium25.toFixed(0))}<span class="label">Karung 25 kg</span></p>
    `;

    document.getElementById("millingOutputContainer").scrollIntoView({ behavior: 'smooth' });
}
</script>

</body>
</html>
